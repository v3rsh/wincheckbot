# Тестовые скрипты для работы с email

В этой директории содержатся скрипты для тестирования отправки email сообщений.

## Предварительные настройки

Для работы скриптов требуются переменные окружения, которые можно задать одним из способов:

1. **Через файл `.env`** - создайте файл `.env` в корневой директории проекта со следующими переменными:
   ```
   UNI_EMAIL=your_email@winline.ru
   UNI_API_KEY=your_api_key
   ```

2. **Через переменные окружения системы** - установите переменные окружения в системе:
   ```bash
   export UNI_EMAIL=your_email@winline.ru
   export UNI_API_KEY=your_api_key
   ```

## Скрипты

### check_env.py

Проверяет наличие необходимых переменных окружения для отправки email.

```bash
python scripts/check_env.py
```

### check_smtp.py

Проверяет доступность SMTP-сервера и поддержку TLS.

```bash
python scripts/check_smtp.py [сервер] [порт]
```

По умолчанию используется сервер `mail.winline.ru` и порт `25`.

### test_mail.py

Отправляет тестовое письмо с кодом подтверждения на указанный email.

```bash
python scripts/test_mail.py
```

## Особенности запуска

Скрипты содержат код для добавления родительской директории в `sys.path`, поэтому их можно запускать напрямую из любой директории:

```bash
# Из корневой директории проекта
python scripts/test_mail.py

# Из директории scripts
cd scripts
python test_mail.py
```

## Особенности реализации

1. Функция `send_test` в `utils/email_sender.py` теперь поддерживает:
   - Multipart/alternative (HTML + текстовая версия)
   - TLS-шифрование (если сервер поддерживает)
   - Дополнительные заголовки для предотвращения попадания в спам

2. В `scripts/test_mail.py` добавлен код для корректного импорта модулей из родительской директории 